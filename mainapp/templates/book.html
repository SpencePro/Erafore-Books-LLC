{% extends 'layout.html' %}
{% load static %}

{% block head %}
{{ book.title }}
{% endblock %}

{% block body %}
<h2>Book Title {{ book.title }}</h2>
<div class="listing hori">
    <div class="vert">
        <img src="{% static book.image %}.avif" alt="{{ book.title }} Cover" width="250px" height="400px">
    </div>
    <div class="vert">
        <a href="{{ book.amazon_link }}" target="_blank" rel="noreferrer noopener">Purchase on Amazon</a>
            
        {% if user.is_authenticated %}
            <form action="{% url 'add' book.id %}" method="POST" class="{{ book.id }}" id="wishlist-form-{{ book.id }}">
                {% csrf_token %}
                <input type="text" name="page" value="book-page" class="hidden">
                {% if wishlist == "" %}
                    <button type="button" id="wish-btn" class="wish-btn">Add to wishlist</button>
                {% else %}
                    <button type="button" id="wish-btn" class="wish-btn">Remove from wishlist</button>
                    <p id="in-wishlist">This book is in your wishlist</p>
                {% endif %}
            </form>
        {% endif %}

        <p>Published {{ book.date_released }}</p>
        
        <div class="hori">
            <label for="book-series">Series:</label>
            <p id="book-series">{{ book.series.name }}</p>
        </div>
        {% if user.is_authenticated %}
            <form action="{% url 'follow' book.series.id %}" method="POST" class="{{ book.series.id }}" id="follow-form-{{ book.series.id }}">
                {% csrf_token %}
                <input type="text" name="page" value="book-page" class="hidden">
                <input type="text" name="book" value="{{ book.id }}" class="hidden">
                {% if following == "" %}
                    <button type="button" id="follow-btn" class="follow-btn">Follow Series</button>
                {% else %}
                    <button type="button" id="follow-btn" class="follow-btn">Unfollow Series</button>
                    <p id="are-following">You are following this series</p>
                {% endif %}
            </form>
        {% endif %}
        
        <div class="hori">
            <label for="book-world">World:</label>
            <p id="book-world">{{ book.world }}</p>
        </div>

        <div class="hori">
            <label for="book-synopsis">Synopsis:</label>
            <p id="book-synopsis">{{ book.synopsis }}
            </p>
        </div>
    </div>
</div>
{% if user.is_authenticated %}
    <script type="text/javascript">
        document.getElementById("wish-btn").addEventListener("click", wishlistFunc);
        document.getElementById("follow-btn").addEventListener("click", followFunc);
    </script>
{% endif %}

{% endblock %}